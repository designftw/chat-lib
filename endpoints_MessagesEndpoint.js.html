<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Adding favicon -->
    

    <!-- Adding meta -->
    

    <!-- Adding external script-->
    

    <!-- Adding external style-->
    

    <!-- Adding scripts-->
    

    <!-- Adding style-->
    

    <!-- Adding overlay script-->
    

    <!-- Adding overlay style-->
    


    <title>
      endpoints/MessagesEndpoint.js
    </title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/third-party/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/third-party/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/reset.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-base.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-light.css">
    
    <svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path
                    d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z" />
                <path
                    d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z" />
            </g>
        </symbol>
        <symbol id='search-icon' viewBox="0 0 512 512">
            <g>
                <g>
                    <path
                        d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z" />
                </g>
            </g>
            <g>
                <g>
                    <path
                        d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z" />
                </g>
            </g>
        </symbol>
        <symbol id="down-icon" viewBox="0 0 16 16">
            <path 
                fill-rule="evenodd" 
                clip-rule="evenodd" 
                d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"
            >
            </path>
        </symbol>
    </defs>
</svg>
  </head>

  <body>

    <nav class="navbar" id="navbar">
      <div class="navbar-heading" id="navbar-heading"><a href="index.html"><h2 class="navbar-heading-text">Home</h2></a></div><div class="search-box" id="search-box"><div class="search-box-input-container"><input class="search-box-input" type="text" placeholder="Search..." id="search-box-input" /><svg class="search-icon" alt="search-icon"><use xlink:href="#search-icon"></use></svg></div><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-main-content" id="sidebar-main-content"><div class="accordion collapsed" id="9222872" > <h3 class="accordion-heading">Classes<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion collapsed child" id=9577209><div class="accordion-heading child"><a href="Account.html">Account</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Account.html#toJSON">toJSON</a></li></ul></li><li class="accordion collapsed child" id=9735642><div class="accordion-heading child"><a href="BaseModel.html">BaseModel</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="BaseModel.html#toJSON">toJSON</a></li></ul></li><li class="accordion collapsed child" id=2892806><div class="accordion-heading child"><a href="Client.html">Client</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Client.html#addFriend">addFriend</a></li><li data-type='method'><a href="Client.html#createIdentity">createIdentity</a></li><li data-type='method'><a href="Client.html#createPrivateData">createPrivateData</a></li><li data-type='method'><a href="Client.html#deleteIdentity">deleteIdentity</a></li><li data-type='method'><a href="Client.html#deleteMessage">deleteMessage</a></li><li data-type='method'><a href="Client.html#deletePrivateData">deletePrivateData</a></li><li data-type='method'><a href="Client.html#getFriends">getFriends</a></li><li data-type='method'><a href="Client.html#getIdentities">getIdentities</a></li><li data-type='method'><a href="Client.html#getIdentity">getIdentity</a></li><li data-type='method'><a href="Client.html#getLoggedInAccount">getLoggedInAccount</a></li><li data-type='method'><a href="Client.html#getMessageById">getMessageById</a></li><li data-type='method'><a href="Client.html#getMessages">getMessages</a></li><li data-type='method'><a href="Client.html#getPrivateData">getPrivateData</a></li><li data-type='method'><a href="Client.html#groupMessagesByUniqueRecipients">groupMessagesByUniqueRecipients</a></li><li data-type='method'><a href="Client.html#login">login</a></li><li data-type='method'><a href="Client.html#logout">logout</a></li><li data-type='method'><a href="Client.html#removeFriend">removeFriend</a></li><li data-type='method'><a href="Client.html#sendMessage">sendMessage</a></li><li data-type='method'><a href="Client.html#signup">signup</a></li><li data-type='method'><a href="Client.html#updateIdentity">updateIdentity</a></li><li data-type='method'><a href="Client.html#updateMessage">updateMessage</a></li><li data-type='method'><a href="Client.html#updatePrivateData">updatePrivateData</a></li></ul></li><li class="accordion collapsed child" id=2699582><div class="accordion-heading child"><a href="Identity.html">Identity</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Identity.html#toJSON">toJSON</a></li><li data-type='method'><a href="Identity.html#toString">toString</a></li></ul></li><li class="accordion collapsed child" id=4280380><div class="accordion-heading child"><a href="Message.html">Message</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Message.html#toJSON">toJSON</a></li></ul></li><li class="accordion collapsed child" id=7184038><div class="accordion-heading child"><a href="PrivateData.html">PrivateData</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="PrivateData.html#toJSON">toJSON</a></li></ul></li></ul> </div><div class="accordion collapsed" id="2105595" > <h3 class="accordion-heading">Events<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="global.html#event:message">message</a></li><li class="accordion-list" id=""><a href="global.html#event:messagedeletion">messagedeletion</a></li><li class="accordion-list" id=""><a href="global.html#event:messageupdate">messageupdate</a></li></ul> </div><div class="accordion collapsed" id="2777896" > <h3 class="accordion-heading">Global<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="global.html#createAlias">createAlias</a></li><li class="accordion-list" id=""><a href="global.html#CreateDefaultRequestInitOptions">CreateDefaultRequestInitOptions</a></li><li class="accordion-list" id=""><a href="global.html#createHeadersFromObject">createHeadersFromObject</a></li><li class="accordion-list" id=""><a href="global.html#createJSONEncodedBody">createJSONEncodedBody</a></li><li class="accordion-list" id=""><a href="global.html#createJSONEncodedHeaders">createJSONEncodedHeaders</a></li><li class="accordion-list" id=""><a href="global.html#deleteAlias">deleteAlias</a></li><li class="accordion-list" id=""><a href="global.html#getAlias">getAlias</a></li><li class="accordion-list" id=""><a href="global.html#getAliasesForAccount">getAliasesForAccount</a></li><li class="accordion-list" id=""><a href="global.html#getErrorFromResponse">getErrorFromResponse</a></li><li class="accordion-list" id=""><a href="global.html#intersection">intersection</a></li><li class="accordion-list" id=""><a href="global.html#messageEventDetails">messageEventDetails</a></li><li class="accordion-list" id=""><a href="global.html#request">request</a></li><li class="accordion-list" id=""><a href="global.html#toArray">toArray</a></li><li class="accordion-list" id=""><a href="global.html#updateAlias">updateAlias</a></li></ul> </div>
      

    </nav>
    <div class="navbar-ham" id="navbar-ham">
      <div>
        <div class="first"></div>
        <div class="second"></div>
        <div class="third"></div>
      </div>
    </div>

    <div id="main" class="main-content">
      
      <h1 id='page-title' class="page-title">
        endpoints/MessagesEndpoint.js
      </h1>
      

      



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Endpoint from "./Endpoint.js";
import Message from "../models/Message.js";

/**
 * The messages endpoint of the chat server.
 * @ignore
 */
export default class MessagesEndpoint extends Endpoint {
	/**
	 * AliasesEndpoint constructor.
	 *
	 * @param {Client} client see [Endpoint's client property]{@link Endpoint#client}
	 */
	constructor(client) {
		super(client);
	}

	/**
	 * Get all the messages sent or received by the alias and the passed in interlocutors.
	 *
	 * If no interlocutors are passed in, returns all the messages sent or received by the alias.
	 *
	 * If for example the passed in interlocutors contains the id for the alias Sally, and the passed
	 * in alias is Jack, then this method returns all messages sent by Jack to Sally, or by Sally to Jack.
	 * If there are multiple interlocutors this method returns all messages sent by Jack to any of the
	 * interlocutors, or by any of the interlocutors to Jack. Note this does not mean that the message
	 * has to be sent to all of the interlocutors to be here. Any pair suffices.
	 * @param {string} ownAlias an alias associated with the currently logged in account
	 * @param {string[] | undefined} interlocutors An optional list of aliases which are either the sender or receiver of the returned messages..
	 * @param {Date | undefined} sinceTime An optional date which filters messages to those which were sent after this time.
	 * @returns {Promise&lt;Message[]>} The messages which pass the filters.
	 */
	async getMessagesForAlias(ownAlias, interlocutors, sinceTime) {
		let headers = {
			"user-alias-name": ownAlias,
		};

		if (interlocutors?.length > 0) {
			headers["interlocutors"] = JSON.stringify(interlocutors);
		}

		if (sinceTime !== undefined) {
			headers["since-time"] = sinceTime.getTime();
		}

		let messagesDTO = await this.request("messages", { headers });

		return messagesDTO.map((messageDTO) => new Message({...messageDTO, data: messageDTO.payload}));
	}

	/**
	 * Send a new message from ownAlias to recipients. The payload is a potentially jsonified string.
	 * @param {string} ownAlias an alias associated with the currently logged in account.
	 * @param {string[]} recipientNames the recipients of the message
	 * @param {Object} messageData the data of the message
	 * @returns {Promise&lt;Message>} The sent message.
	 */
	async sendMessage(ownAlias, recipientNames, messageData) {
		let responseDTO = await this.request("messages", {
			method: "POST",
			body: {
				payload: JSON.stringify(messageData),
				recipients: recipientNames,
			},
			headers: {
				"user-alias-name": ownAlias,
			},
		});

		const messageDTO = responseDTO.data;
		return this.getMessage(ownAlias, messageDTO.id);
	}

	/**
	 * Get a single message by it's id.
	 * @param {string} ownAlias the alias associated with the message id, either the sender or recipient.
	 * @param {string} messageId The Message Id. see [Message's id property]{@link Message#id}
	 * @returns {Promise&lt;Message>} The message associated with the passed in id.
	 */
	async getMessage(ownAlias, messageId) {
		let messageDTO = await this.request(`messages/${messageId}`, {
			headers: {
				"user-alias-name": ownAlias,
			}
		});

		return new Message({...messageDTO, data: messageDTO.payload});
	}

	/**
	 * Update a single message by it's id.
	 * @param {string} ownAlias the alias associated with the message id. Must be the sender of the message.
	 * @param {string} messageId The Message Id. see [Message's id property]{@link Message#id}
	 * @param {Object} data The new payload to be associated with the message. See [Message's payload property]{@link Message#payload}
	 * @returns {Promise&lt;Message>} The updated message
	 */
	async updateMessage(ownAlias, messageId, data) {
		let resultDTO = await this.request(`messages/${messageId}`, {
			method: "PUT",
			body: { payload: JSON.stringify(data) },
			headers: {
				"user-alias-name": ownAlias,
			},
		});

		const messageDTO = resultDTO.data;
		return this.getMessage(ownAlias, messageDTO.id);
	}

	/**
	 * Delete a single message by its id.
	 * @param {string} ownAlias the alias associated with the message id, either the sender or recipient.
	 * @param {string} messageId The Message Id. see [Message's id property]{@link Message#id}
	 * @returns {Promise&lt;any>} A validation message.
	 */
	deleteMessage(ownAlias, messageId) {
		return this.request(`messages/${messageId}`, {
			method: "DELETE",
			headers: {
				"user-alias-name": ownAlias,
			},
		});
	}
}
</code></pre>
        </article>
    </section>




    </div>

    <footer class="footer" id="footer">
      
    </footer>

    <script src="scripts/third-party/prettify.js"></script>
    <script src="scripts/third-party/lang-css.js"></script>
    <script type="text/javascript" src="scripts/misc.js"></script>

    <script>prettyPrint();</script>
    <script src="scripts/linenumber.js"></script>
    <script src="scripts/fix-code-block.js"></script>
    <script src="scripts/fix-navbar.js"></script>
    
      <script src="scripts/search.js"></script>
      <script src="scripts/third-party/fuse.js"></script>
      <script>
        var list = [{"title":"Account","link":"<a href=\"Account.html\">Account</a>"},{"title":"Account#toJSON","link":"<a href=\"Account.html#toJSON\">Account &rtrif; toJSON</a>"},{"title":"BaseModel","link":"<a href=\"BaseModel.html\">BaseModel</a>"},{"title":"BaseModel#toJSON","link":"<a href=\"BaseModel.html#toJSON\">BaseModel &rtrif; toJSON</a>"},{"title":"Client","link":"<a href=\"Client.html\">Client</a>"},{"title":"Client#addFriend","link":"<a href=\"Client.html#addFriend\">Client &rtrif; addFriend</a>"},{"title":"Client#createIdentity","link":"<a href=\"Client.html#createIdentity\">Client &rtrif; createIdentity</a>"},{"title":"Client#createPrivateData","link":"<a href=\"Client.html#createPrivateData\">Client &rtrif; createPrivateData</a>"},{"title":"Client#deleteIdentity","link":"<a href=\"Client.html#deleteIdentity\">Client &rtrif; deleteIdentity</a>"},{"title":"Client#deleteMessage","link":"<a href=\"Client.html#deleteMessage\">Client &rtrif; deleteMessage</a>"},{"title":"Client#deletePrivateData","link":"<a href=\"Client.html#deletePrivateData\">Client &rtrif; deletePrivateData</a>"},{"title":"Client#getFriends","link":"<a href=\"Client.html#getFriends\">Client &rtrif; getFriends</a>"},{"title":"Client#getIdentities","link":"<a href=\"Client.html#getIdentities\">Client &rtrif; getIdentities</a>"},{"title":"Client#getIdentity","link":"<a href=\"Client.html#getIdentity\">Client &rtrif; getIdentity</a>"},{"title":"Client#getLoggedInAccount","link":"<a href=\"Client.html#getLoggedInAccount\">Client &rtrif; getLoggedInAccount</a>"},{"title":"Client#getMessageById","link":"<a href=\"Client.html#getMessageById\">Client &rtrif; getMessageById</a>"},{"title":"Client#getMessages","link":"<a href=\"Client.html#getMessages\">Client &rtrif; getMessages</a>"},{"title":"Client#getPrivateData","link":"<a href=\"Client.html#getPrivateData\">Client &rtrif; getPrivateData</a>"},{"title":"Client#groupMessagesByUniqueRecipients","link":"<a href=\"Client.html#groupMessagesByUniqueRecipients\">Client &rtrif; groupMessagesByUniqueRecipients</a>"},{"title":"Client#login","link":"<a href=\"Client.html#login\">Client &rtrif; login</a>"},{"title":"Client#logout","link":"<a href=\"Client.html#logout\">Client &rtrif; logout</a>"},{"title":"Client#removeFriend","link":"<a href=\"Client.html#removeFriend\">Client &rtrif; removeFriend</a>"},{"title":"Client#sendMessage","link":"<a href=\"Client.html#sendMessage\">Client &rtrif; sendMessage</a>"},{"title":"Client#signup","link":"<a href=\"Client.html#signup\">Client &rtrif; signup</a>"},{"title":"Client#updateIdentity","link":"<a href=\"Client.html#updateIdentity\">Client &rtrif; updateIdentity</a>"},{"title":"Client#updateMessage","link":"<a href=\"Client.html#updateMessage\">Client &rtrif; updateMessage</a>"},{"title":"Client#updatePrivateData","link":"<a href=\"Client.html#updatePrivateData\">Client &rtrif; updatePrivateData</a>"},{"title":"Identity","link":"<a href=\"Identity.html\">Identity</a>"},{"title":"Identity#toJSON","link":"<a href=\"Identity.html#toJSON\">Identity &rtrif; toJSON</a>"},{"title":"Identity#toString","link":"<a href=\"Identity.html#toString\">Identity &rtrif; toString</a>"},{"title":"Message","link":"<a href=\"Message.html\">Message</a>"},{"title":"Message#toJSON","link":"<a href=\"Message.html#toJSON\">Message &rtrif; toJSON</a>"},{"title":"PrivateData","link":"<a href=\"PrivateData.html\">PrivateData</a>"},{"title":"PrivateData#toJSON","link":"<a href=\"PrivateData.html#toJSON\">PrivateData &rtrif; toJSON</a>"},{"title":"message","link":"<a href=\"global.html#event:message\">message</a>"},{"title":"messagedeletion","link":"<a href=\"global.html#event:messagedeletion\">messagedeletion</a>"},{"title":"messageupdate","link":"<a href=\"global.html#event:messageupdate\">messageupdate</a>"},{"title":"createAlias","link":"<a href=\"global.html#createAlias\">createAlias</a>"},{"title":"CreateDefaultRequestInitOptions","link":"<a href=\"global.html#CreateDefaultRequestInitOptions\">CreateDefaultRequestInitOptions</a>"},{"title":"createHeadersFromObject","link":"<a href=\"global.html#createHeadersFromObject\">createHeadersFromObject</a>"},{"title":"createJSONEncodedBody","link":"<a href=\"global.html#createJSONEncodedBody\">createJSONEncodedBody</a>"},{"title":"createJSONEncodedHeaders","link":"<a href=\"global.html#createJSONEncodedHeaders\">createJSONEncodedHeaders</a>"},{"title":"deleteAlias","link":"<a href=\"global.html#deleteAlias\">deleteAlias</a>"},{"title":"getAlias","link":"<a href=\"global.html#getAlias\">getAlias</a>"},{"title":"getAliasesForAccount","link":"<a href=\"global.html#getAliasesForAccount\">getAliasesForAccount</a>"},{"title":"getErrorFromResponse","link":"<a href=\"global.html#getErrorFromResponse\">getErrorFromResponse</a>"},{"title":"intersection","link":"<a href=\"global.html#intersection\">intersection</a>"},{"title":"messageEventDetails","link":"<a href=\"global.html#messageEventDetails\">messageEventDetails</a>"},{"title":"request","link":"<a href=\"global.html#request\">request</a>"},{"title":"toArray","link":"<a href=\"global.html#toArray\">toArray</a>"},{"title":"updateAlias","link":"<a href=\"global.html#updateAlias\">updateAlias</a>"}];
        var options = 
          setupSearch(list, options)
      </script>
    

    

    

    


  </body>

</html>
